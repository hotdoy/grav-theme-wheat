{% set image = image ?? null %}
{% set alt = alt ?? null %}
{% set title = title ?? null %}
{% set width = image ? image.width : null %}
{% set height = image ? image.height : null %}
{% set type =  image ? image.type : null %}
{% set system_quality = system.images.default_image_quality ?? '85' %}
{% set quality = image.quality matches '/^\\d+$/' ? image.quality > system_quality ? system_quality : image.quality %}
{% set bypass = image ? '_bypass' in image.filename : false %}

{% if type == 'vector' %}
{{ image.loading.html(title, alt)|raw }}
{% elseif bypass %}
{{ image.attribute('width', width).attribute('height', height).loading.html(title, alt)|raw }}
{% else %}
{{ image.attribute('width', width).attribute('height', height).quality(quality).loading.html(title, alt)|raw }}
{% endif %}
