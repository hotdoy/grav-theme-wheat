{% extends 'partials/base.html.twig' %}

{% set main_image = page.header.image ? page.media[page.header.image] %}
{% set main_image_alt = page.header.image_alt ?? '' %}
{% set other_images = page.header.images %}

{# {% block head_extra %}
<meta name="uid" content="{{ page.id() }}">
{% endblock %} #}

{% block content %}

{# 	{% set currentId = page.id() %}
	{{ currentId }}
	<br>
	{% set options = { items: {'@root.descendants':''} } %}
	{% set pages = page.collection(options) %}
	{% for page in pages if page.routable and page.id() == currentId %}
		{{ page.id() }}
	{% endfor %} #}


	{# SHOWCASE #}
	<section class="module product-showcase">
		<div class="wrapper">

			<div class="media-ctn" data-reveal>

				{# SWIPER #}
				{% if other_images %}
				<div class="swiper-container">
					<div class="swiper-wrapper">
						{% if main_image %}
						<div class="swiper-slide">
							<div class="fill">{{ main_image.html('', main_image_alt) }}</div>
						</div>
						{% endif %}
						{% for item in other_images %}
						<div class="swiper-slide">
							{% set image = item.image ? page.media[item.image] %}
							{% set image_alt = item.image_alt ?? '' %}
							{% if image %}
							<div class="fill">{{ image.html('', image_alt) }}</div>
							{% endif %}
						</div>
						{% endfor %}
					</div>
					<div class="swiper-pagination"></div>
				</div>

				{# SINGLE IMAGE	 #}
				{% elseif main_image %}
				<div class="single-image">
					<div class="fill">{{ main_image.html('', main_image_alt) }}</div>
				</div>
				{% endif %}

			</div>

			<div class="content-ctn" data-reveal>
				<div class="sticky-ctn">
					{% include 'partials/breadcrumbs.html.twig' %}
				    {% set title = page.header.display_title ?? page.title %}
				    <h1 class="name">{{ title }}</h1>
					<div class="description text">{{ page.content|raw }}</div>
					<div class="price">{{ page.header.price|number_format(2, ',', ' ') }} $</div>
					{% include 'partials/snipcart-add-item.html.twig' with {'class': 'add-to-cart button'} %}
				</div>
			</div>
		</div>
	</section>

	{# MOBILE BUY BUTTON #}
	<section class="bottom-bar">
		<div class="price">{{ page.header.price|number_format(2, ',', ' ') }} $</div>
		{% include 'partials/snipcart-add-item.html.twig' with {'class': 'add-to-cart button'} %}
	</section>

	{# MODULES #}
	{% for module in page.collection({ items: {'@self.modular':''}, 'order': {'by':'folder', 'dir':'asc'}}) %}
	{{ module.content|raw }}
	{% endfor %}

	{# RELATED ITEMS #}
    {# {% set options = { items: {'@self.siblings':''}, 'limit': 4, 'order': {'by': 'random'}} %} #}
    {# {% set related = page.collection(options) %} #}


{% endblock %}
